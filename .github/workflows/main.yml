name: Jupyter Notebook Runner

on:
  push:
    branches: [ main, master ]
  workflow_dispatch:

jobs:
  run-notebook:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.10'
      
      # ğŸ’¡ 1. ì˜ì¡´ì„± ì„¤ì¹˜ (papermill í¬í•¨)
      - name: Install dependencies (including Papermill)
        run: |
          python -m pip install --upgrade pip
          pip install -r requirements.txt # papermill ë° í•„ìš”í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜

      # ğŸ’¡ 2. Jupyter Notebook ì‹¤í–‰ (í•µì‹¬)
      - name: Execute Jupyter Notebook
        run: |
          # ----------------------------------------------------------------------
          # papermillì„ ì‚¬ìš©í•˜ì—¬ code í´ë” ë‚´ì˜ ë…¸íŠ¸ë¶ íŒŒì¼ì„ ì‹¤í–‰í•©ë‹ˆë‹¤.
          #
          # ì‚¬ìš©ë²•: papermill <ì…ë ¥ ë…¸íŠ¸ë¶ ê²½ë¡œ> <ì¶œë ¥ ë…¸íŠ¸ë¶ ê²½ë¡œ>
          # ----------------------------------------------------------------------
          papermill code/analysis.ipynb code/analysis_output.ipynb
          
      # 3. (ì„ íƒ ì‚¬í•­) ì‹¤í–‰ëœ ë…¸íŠ¸ë¶ ê²°ê³¼ íŒŒì¼ì„ ë‹¤ì‹œ ì»¤ë°‹
      - name: Commit executed notebook
        uses: stefanzweifel/git-auto-commit-action@v5
        with:
          commit_message: 'Feat: Automated execution of analysis notebook'
          files: 'code/analysis_output.ipynb' # ì‹¤í–‰ ê²°ê³¼ íŒŒì¼ì„ ì»¤ë°‹
